<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription au Grand Jeu Immersif</title>
</head>

<body>
    <h1>Inscription au Grand Jeu Immersif √† √âpinac</h1>

    <form id="registration-form">
        <label for="team-name">Nom de l'√©quipe :</label>
        <input type="text" id="team-name" name="team_name" required><br><br>

        <label for="phone-number">Num√©ro de t√©l√©phone :</label>
        <input type="tel" id="phone-number" name="phone_number" required placeholder="Ex : 0612345678"><br><br>
        <p style="color: red;"><strong>‚ö† Le num√©ro de t√©l√©phone est obligatoire et doit √™tre un num√©ro valide.</strong></p>

        <label for="participants">Nombre de participants :</label>
        <input type="number" id="participants" name="participants" min="1" required><br><br>

        <!-- BOUTONS : Test & Paiement -->
        <button type="button" onclick="testTelegram()">TEST - Envoi Telegram sans payer</button>
        <button type="button" onclick="redirectToPayPal(event)">S'inscrire et payer avec PayPal</button>
    </form>

    <!-- R√©cup√©rer les variables Netlify via la fonction serverless -->
    <script>
        console.log("üîÑ Chargement des variables d‚Äôenvironnement...");

        fetch("/.netlify/functions/env")
            .then(response => response.json())
            .then(data => {
                window.env = {
                    VITE_TELEGRAM_BOT_TOKEN: data.VITE_TELEGRAM_BOT_TOKEN || "",
                    VITE_TELEGRAM_CHAT_ID: data.VITE_TELEGRAM_CHAT_ID || "",
                    ABSTRACT_API_KEY: data.ABSTRACT_API_KEY || "",
                    SMS_API_KEY: data.SMS_API_KEY || ""  // üîπ Ajout de la cl√© SMS_API_KEY
                };

                console.log("üü¢ Variables Netlify r√©cup√©r√©es :", window.env);

                // V√©rification si SMS_API_KEY est bien r√©cup√©r√©e
                if (!window.env.SMS_API_KEY) {
                    console.warn("‚ö† Alerte : SMS_API_KEY est introuvable !");
                }
            })
            .catch(error => {
                console.error("‚ùå Erreur lors de la r√©cup√©ration des variables Netlify :", error);
            });
    </script>

    <!-- Charger le fichier JavaScript principal -->
    <script src="/script.js" defer></script>

</body>
</html>