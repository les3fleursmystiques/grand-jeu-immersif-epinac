

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription au Grand Jeu Immersif</title>
</head><script>
    function sendTelegramMessage(phoneNumber) {
        let token = process.env.TELEGRAM_BOT_TOKEN;
        let chatId = "5657829843";  // Remplace par l'ID du joueur
        let message = "Bienvenue au Grand Jeu Immersif ! üéâ\nVotre premi√®re question arrive bient√¥t.";

        let url = "https://api.telegram.org/bot" + token + "/sendMessage?chat_id=" + chatId + "&text=" + encodeURIComponent(message);

        fetch(url)
            .then(response => console.log("Message envoy√© √† Telegram"))
            .catch(error => console.error("Erreur Telegram :", error));
    }

    function redirectToPayPal(event) {
        event.preventDefault();  // Emp√™che l‚Äôenvoi du formulaire imm√©diatement

        let participants = document.getElementById("participants").value;
        let phoneNumber = document.getElementById("phone-number").value;
        let paypalLink = "https://www.paypal.me/tonpseudo/" + (5 * participants);

        // Envoyer le message Telegram apr√®s inscription
        sendTelegramMessage(phoneNumber);

        // Soumettre le formulaire d'inscription
        document.getElementById("registration-form").submit();

        // Ouvrir PayPal pour le paiement
        window.open(paypalLink, "_blank");
    }
</script>

<body>
    <h1>Inscription au Grand Jeu Immersif √† √âpinac</h1>

    <form id="registration-form" method="post" action="https://formspree.io/f/xqaeddrw">
    <label for="team-name">Nom de l'√©quipe :</label>
    <input type="text" id="team-name" name="team_name" required><br><br>

    <label for="phone-number">Num√©ro de t√©l√©phone :</label>
    <input type="tel" id="phone-number" name="phone_number" pattern="^(\+33|0)[1-9]\d{8}$" required placeholder="Ex : 0612345678"><br><br>
    <p style="color: red;"><strong>‚ö† Le num√©ro de t√©l√©phone est obligatoire pour recevoir les questions du jeu.</strong></p>

    <label for="participants">Nombre de participants :</label>
    <input type="number" id="participants" name="participants" min="1" required><br><br>

    <!-- BOUTON UNIQUE : INSCRIPTION + PAIEMENT PAYPAL -->
    <button type="submit" onclick="redirectToPayPal(event)">S'inscrire et payer avec PayPal</button>
</form>

<script>
    function redirectToPayPal(event) {
        event.preventDefault(); // Emp√™che l'envoi du formulaire imm√©diatement

        let participants = document.getElementById("participants").value;
        let totalPrice = 5 * participants; // Calcule le montant total
        let pseudo = encodeURIComponent("https://paypal.me/LaurieBlanot?country.x=FR&locale.x=fr_FR"); // Encode le pseudo pour √©viter le bug du "?"
	let paypalLink = "https://paypal.me/LaurieBlanot?country.x=FR&locale.x=fr_FR/" + totalPrice + "EUR";
        alert("Montant √† payer : " + totalPrice + " ‚Ç¨"); // Affiche le montant en ‚Ç¨ avant de payer

        // Soumettre le formulaire pour envoyer les infos de l'inscription
        document.getElementById("registration-form").submit();

        // Ouvrir PayPal apr√®s l'inscription
        // window.open(paypalLink, "_blank");
    }
</script>

</a>
    </form>
</body>
</html>