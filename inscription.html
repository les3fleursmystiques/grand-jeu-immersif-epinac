<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription au Grand Jeu Immersif</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="header">
        <img src="images/logo-myssea.png" alt="Logo Myssea">
    </div>

    <h1>Inscription au Grand Jeu Immersif √† √âpinac</h1>

    <div id="telegram-warning">
        <strong>‚ö† IMPORTANT :</strong>
        <p>Vous devez avoir un <strong>pseudo Telegram</strong> et avoir contact√© notre bot.</p>
        <p>üì≤ <a href="https://telegram.org" target="_blank">T√©l√©chargez Telegram</a></p>
        <p>üîπ <a href="https://www.google.com/search?q=cr√©er+un+pseudo+Telegram" target="_blank">Comment cr√©er un pseudo Telegram ?</a></p>
    </div>

    <form id="registration-form">
        <label for="team-name">Nom de l'√©quipe :</label>
        <input type="text" id="team-name" name="team_name" required><br><br>

        <label for="telegram-username">Nom d'utilisateur Telegram :</label>
        <input type="text" id="telegram-username" name="telegram_username" required placeholder="Ex: @monpseudo"><br><br>
        <p style="color: red;"><strong>‚ö† Entrez correctement votre identifiant Telegram (ex: @votrePseudo)</strong></p>

        <label for="participants">Nombre de participants :</label>
        <input type="number" id="participants" name="participants" min="1" required><br><br>

        <label for="promo-code">Code promo (facultatif) :</label>
        <input type="text" id="promo-code" name="promo_code" placeholder="Ex: MYSSEPA2"><br><br>

        <p id="promo-warning" style="color: red; display: none;"></p>

        <button type="submit" id="pay-btn" style="background-color: #4CAF50; cursor: pointer;">
 		 ‚úÖ Valider et acc√©der au jeu
	</button>
    </form>

    <script>
        const validPromoCodes = {
            "MYSSEPA1": 1,
            "MYSSEPA2": 2,
            "MYSSEPRO": 5,
            "MYSSEADMINITY": Infinity
        };

        const paypalLink = "https://paypal.me/LaurieBlanot?country.x=FR&locale.x=fr_FR";

        document.addEventListener("DOMContentLoaded", function () {
            const telegramInput = document.getElementById("telegram-username");
            const teamInput = document.getElementById("team-name");
            const participantsInput = document.getElementById("participants");
            const promoInput = document.getElementById("promo-code");
            const payBtn = document.getElementById("pay-btn");
            const warningText = document.getElementById("promo-warning");

            telegramInput.addEventListener("blur", function () {
                if (!telegramInput.value.startsWith("@")) {
                    telegramInput.value = "@" + telegramInput.value;
                }
            });

            document.getElementById("registration-form").addEventListener("input", function () {
                const username = telegramInput.value.trim();
                const team = teamInput.value.trim();
                const count = parseInt(participantsInput.value) || 0;
                const code = promoInput.value.trim().toUpperCase();
                const isFilled = username && team && count > 0;

                if (!isFilled) {
                    disablePayBtn("‚õî Inscription temporairement ferm√©e ‚õî");
                    return;
                }

                // Cas sp√©cial : acc√®s admin (acc√®s-reel.html)
                if (code === "MYSSEADMINITY") {
                    window.location.href = "acces-reel.html";
                    return;
                }

                // Codes promo classiques
                if (code in validPromoCodes) {
                    const maxAllowed = validPromoCodes[code];
                    if (count <= maxAllowed) {
                        warningText.style.display = "none";
                        enablePayBtn("‚úÖ Code promo accept√© ‚Äî inscription gratuite", "acces.html");
                    } else {
                        warningText.innerText = `‚ö† Le code "${code}" est limit√© √† ${maxAllowed} participant(s). Veuillez r√©gler la diff√©rence.`;
                        warningText.style.display = "block";
                        enablePayBtn("‚û° Payer la diff√©rence sur PayPal", paypalLink);
                    }
                } else if (code === "") {
                    warningText.style.display = "none";
                    enablePayBtn("‚û° Payer sur PayPal", paypalLink);
                } else {
                    warningText.innerText = `‚ö† Code promo non reconnu.`;
                    warningText.style.display = "block";
                    disablePayBtn("‚õî Inscription temporairement ferm√©e ‚õî");
                }
            });

            function disablePayBtn(label) {
                payBtn.innerText = label;
                payBtn.disabled = true;
                payBtn.style.backgroundColor = "grey";
                payBtn.style.cursor = "not-allowed";
                payBtn.onclick = null;
            }

            function enablePayBtn(label, link) {
                payBtn.innerText = label;
                payBtn.disabled = false;
                payBtn.style.backgroundColor = "#4CAF50";
                payBtn.style.cursor = "pointer";
                payBtn.onclick = function () {
                    if (link) {
                        window.open(link, "_blank");
                    } else {
                        alert("Inscription valid√©e !");
                    }
                };
            }
        });
    </script>
</body>
</html>